<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="A lightweight Yii application embedded into OpenCart">

    <title>Yii Embed for OpenCart</title>

    <link href="//cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.5/jquery.fancybox.min.css" rel="stylesheet">
    <link href="css/bootstrap-flatly.css" rel="stylesheet">
    <link href="css/prettify.css" rel="stylesheet" type="text/css">
    <link href="css/main.css" rel="stylesheet" type="text/css">
</head>
<body>

<nav class="navbar navbar-default navbar-fixed-top" role="navigation">

    <a href="https://github.com/cornernote/yii-embed-opencart"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png" alt="Fork me on GitHub"></a>

    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="#">Yii Embed for OpenCart</a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                <li class="dropdown">
                    <a class="dropdown-toggle" data-toggle="dropdown" href="#">Features <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        <li>
                            <a href="#features">Features</a>
                        </li>
                        <li class="divider"></li>
                        <li>
                            <a href="#features/screenshots">Screenshots</a>
                        </li>
                    </ul>
                </li>
                <li class="dropdown">
                    <a class="dropdown-toggle" data-toggle="dropdown" href="#">Installation <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        <li>
                            <a href="#installation">Installation</a>
                        </li>
                        <li class="divider"></li>
                        <li>
                            <a href="#installation/requirements">Requirements</a>
                        </li>
                        <li>
                            <a href="#installation/vqmod-installation">vQmod Installation</a>
                        </li>
                        <li>
                            <a href="#installation/manual-installation">Manual Installation</a>
                        </li>
                    </ul>
                </li>
                <li class="dropdown">
                    <a class="dropdown-toggle" data-toggle="dropdown" href="#">Configuration <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        <li>
                            <a href="#configuration">Configuration</a>
                        </li>
                        <li class="divider"></li>
                        <li>
                            <a href="#configuration/extending">Extending and Upgrading</a>
                        </li>
                        <li>
                            <a href="#configuration/common-issues">Common Issues</a>
                        </li>
                    </ul>
                </li>
                <li class="dropdown">
                    <a class="dropdown-toggle" data-toggle="dropdown" href="#">Usage <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        <li>
                            <a href="#usage">Usage</a>
                        </li>
                        <li class="divider"></li>
                        <li>
                            <a href="#usage/examples">Examples</a>
                        </li>
                        <li>
                            <a href="#usage/gii">Gii Code Generator</a>
                        </li>
                    </ul>
                </li>
            </ul>
        </div>
    </div>
</nav>
<div id="header">
    <div class="container">
        <div class="jumbotron">
            <h1>Yii Embed for OpenCart</h1>

            <p>A lightweight Yii application embedded into OpenCart.</p>

            <p>
                <a class="btn btn-primary btn-lg" role="button" href="#installation">Installation</a>
                <a class="btn btn-default btn-lg" role="button" href="#configuration">Configuration</a>
                <a class="btn btn-default btn-lg" role="button" href="#usage">Usage</a>
            </p>
        </div>
    </div>
</div>

<div class="container">

<div class="section">
    <h2 id="features">Features</h2>
    <ul>
        <li>Yii is available from anywhere in OpenCart using <code>Yii::app()</code> or <code>Yii::foobar</code></li>
        <li>OpenCart registry is available from anywhere in Yii using <code>Yii::app()-&gt;registry</code></li>
        <li>Controllers and Modules are handled by the OpenCart not_found.php controller</li>
        <li>Models are built that represent all OpenCart-1.5.6 tables including relations</li>
        <li>Generate models for all your tables in one step and create standard Yii Crud using Gii</li>
        <li>Autoload any of your Yii models and components from anywhere in OpenCart</li>
        <li>Widgets can be rendered and will auto-include their stylesheet and javascript files</li>
        <li>OpenCart controllers and child actions can be run within Yii</li>
        <li>OpenCart languages can be loaded and output within Yii</li>
        <li>Uses Yii pretty error message and stack dump</li>
    </ul>
    <p>The following Yii components are pre-configured to work in your OpenCart:</p>
    <ul>
        <li>
            <code>Yii::app()-&gt;assetManager</code> -
            <a href="http://www.yiiframework.com/doc/api/1.1/CAssetManager">CAssetManager</a>
        </li>
        <li>
            <code>Yii::app()-&gt;clientScript</code> -
            <a href="http://www.yiiframework.com/doc/api/1.1/CClientScript">CClientScript</a>
        </li>
        <li>
            <code>Yii::app()-&gt;controller</code> -
            <a href="http://www.yiiframework.com/doc/api/1.1/CController">CController</a>
        </li>
        <li>
            <code>Yii::app()-&gt;db</code> -
            <a href="http://www.yiiframework.com/doc/api/1.1/CDbConnection">CDbConnection</a>
        </li>
        <li>
            <code>Yii::app()-&gt;errorHandler</code> -
            <a href="http://www.yiiframework.com/doc/api/1.1/CErrorHandler">CErrorHandler</a>
        </li>
        <li>
            <code>Yii::app()-&gt;session</code> -
            <a href="http://www.yiiframework.com/doc/api/1.1/CHttpSession">CHttpSession</a>
        </li>
        <li>
            <code>Yii::app()-&gt;urlManager</code> -
            <a href="http://www.yiiframework.com/doc/api/1.1/CUrlManager">CUrlManager</a>
        </li>
        <li>
            <code>Yii::app()-&gt;messages</code> -
            <a href="http://www.yiiframework.com/doc/api/1.1/CMessageSource">CMessageSource</a>
        </li>
    </ul>

    <h3 id="features/screenshots">Screenshots</h3>

    <div class="row">
        <div class="col-xs-6 col-md-3">
            <div class="thumbnail">
                <a href="img/screenshot/catalog.png" class="fancybox" rel="screenshots"><img src="img/screenshot/catalog.png" alt="ss"></a>
            </div>
            <div class="caption text-center">Rendering the default Yii SiteController -
                <code>index.php?route=site/index</code></div>
        </div>
        <div class="col-xs-6 col-md-3">
            <div class="thumbnail">
                <a href="img/screenshot/admin.png" class="fancybox" rel="screenshots"><img src="img/screenshot/admin.png" alt="ss"></a>
            </div>
            <div class="caption text-center">Rendering the default admin Yii SiteController -
                <code>admin/index.php?route=site/index</code></div>
        </div>
        <div class="col-xs-6 col-md-3">
            <div class="thumbnail">
                <a href="img/screenshot/gii.png" class="fancybox" rel="screenshots"><img src="img/screenshot/gii.png" alt="ss"></a>
            </div>
            <div class="caption text-center">Using Gii to build all models -
                <code>admin/index.php?route=gii/prefixModel/index</code></div>
        </div>
    </div>
    <div class="row">
        <div class="col-xs-6 col-md-3">
            <div class="thumbnail">
                <a href="img/screenshot/error-debug.png" class="fancybox" rel="screenshots"><img src="img/screenshot/error-debug.png" alt="ss"></a>
            </div>
            <div class="caption text-center">An error with <code>YII_DEBUG</code> set to <code>true</code></div>
        </div>
        <div class="col-xs-6 col-md-3">
            <div class="thumbnail">
                <a href="img/screenshot/error-live.png" class="fancybox" rel="screenshots"><img src="img/screenshot/error-live.png" alt="ss"></a>
            </div>
            <div class="caption text-center">An error with <code>YII_DEBUG</code> set to <code>false</code></div>
        </div>
    </div>

</div>

<div class="section">
    <h2 id="installation">Installation</h2>

    <p>Download the <a href="https://github.com/cornernote/yii-embed-opencart/releases/latest">latest release</a> or
        <a href="https://github.com/cornernote/yii-embed-opencart/archive/master.zip">development version</a> and uncompress the <code>upload</code> folder into your opencart installation.
    </p>

    <h3 id="installation/requirements">Requirements</h3>

    <p>The application has been tested with the following software versions, however should work with any minor revision change:</p>

    <ul>
        <li>
            <a href="http://www.opencart.com/index.php?route=download/download/download&download_id=32">OpenCart-1.5.6</a> (should work in OpenCart-1.5.*)
        </li>
        <li>
            <a href="https://github.com/yiisoft/yii/releases/download/1.1.14/yii-1.1.14.f0fee9.zip">Yii-1.1.14</a> (should work in Yii-1.1.*)
            <br/>Uncompress it into your opencart <code>system</code> folder. The <code>yii.php</code> file should be in
            <code>system/yii/framework/yii.php</code>.
        </li>
    </ul>


    <h3 id="installation/vqmod-installation">vQmod Installation</h3>

    <p>If you have installed
        <a href="https://code.google.com/p/vqmod/">vQmod</a> then no further installation is required.</p>

    <h3 id="installation/manual-installation">Manual Installation</h3>

    <h4><code>system/startup.php</code></h4>
    
    <p><strong>BEFORE</strong> the closing php tag <code>?&gt;</code></p>

    <pre class="prettyprint lang-php">require_once(DIR_SYSTEM . 'yiiembed/yiiembed.php');</pre>

    <h4><code>system/engine/front.php</code></h4>

    <p><strong>AFTER</strong> <code>$this-&gt;registry = $registry;</code></p>

    <pre class="prettyprint lang-php">Yii::createApplication('OcWebApplication', array('registry' => $registry, 'front' => $this));</pre>

    <h4><code>system/library/response.php</code></h4>

    <p><strong>BEFORE</strong> <code>echo $output;</code></p>

    <pre class="prettyprint lang-php">Yii::app()->clientScript->render($output);</pre>

    <h4><code>catalog/controller/error/not_found.php</code> and <code>admin/controller/error/not_found.php</code></h4>

    <p><strong>AFTER</strong> <code>public function index() {</code></p>

    <pre class="prettyprint lang-php">Yii::app()->runController();</pre>

    <h4><code>admin/controller/user/user_permission.php</code></h4>
    
    <p><strong>AFTER</strong> <code>$this->data['permissions'] = array();</code></p>

    <pre class="prettyprint lang-php">$this->data['permissions'] = array_merge($this->data['permissions'], Yii::app()->getPermissionList());</pre>

    <h4><code>system/library/user.php</code></h4>
    
    <p><strong>BEFORE</strong> <code>return in_array($value, $this->permission[$key]);</code></p>

    <pre class="prettyprint lang-php">if (in_array(implode('/', array_slice(explode('/', $value), 0, 1)), $this->permission[$key])) return true;</pre>

</div>

<div class="section">
    <h2 id="configuration">Configuration</h2>

    <p>Copy the Yii config files in <code>catalog/yiiembed/config/main-dist.php</code> and
        <code>admin/yiiembed/config/main-dist.php</code> to <code>main.php</code>.</p>

    <p>Add Yii constants to your OpenCart config.php, defaults shown below:</p>

        <pre class="prettyprint linenums lang-php">define('YII_DEBUG', false); // set to true for fancy error messages
define('YII_TRACE_LEVEL', 0);
define('YII_ENABLE_EXCEPTION_HANDLER', true);
define('YII_ENABLE_ERROR_HANDLER', true);</pre>

    <h3 id="configuration/extending">Extending and Upgrading</h3>

    <p>The files in <code>catalog/yiiembed</code> and
        <code>admin/yiiembed</code> are intended to be modified by you. When upgrading please ensure you do not overwrite your modified yiiembed applications with the default applications.
    </p>

    <p>The files in
        <code>system/yiiembed</code> are intended to be in-sync with this project. Please avoid changing them, you can extend them if you require modifications.
    </p>

    <h3 id="configuration/common-issues">Common Issues</h3>

    <h4>JavaScript not working</h4>

    <p>It is probably because your JavaScript from Yii is outputting too early.  The <code>&lt;title&gt;</code> tag is too high on the page.  Yii outputs all the CSS/JS right before the <code>&lt;title&gt;</code> tag, so try moving it below your other CSS/JS files.</p>

    <h4>enableClientValidation not working in catalog when using chrome</h4>

    <p>jQuery in chrome treats inline elements as hidden. In the default opencart stylesheet on line 46, there is CSS to make forms display inline.  You can remove this, or add <code>'htmlOptions' => array('style'=>'display:block;')</code> to your form.</p>

    <h4>Model name conflicts</h4>

    <p>If you get an error like <code>Customer::__construct() Missing argument 1 for Customer::__construct()</code>, it is because there is already a Customer class built into OpenCart.  You should name your models with a prefix, for example <code>OcCustomer</code>.</p>

</div>

<div class="section">
    <h2 id="usage">Usage</h2>

    <h3 id="usage/examples">Examples</h3>

    <p>Find and save a record (in this example we use a Customer):</p>

        <pre class="prettyprint linenums lang-php">$customer_id = 123;
$customer = OcCustomer::model()->findByPk($customer_id);
if ($customer) {
    $customer->firstname = 'Foo';
    $customer->lastname = 'Bar';
    $customer->save();
}</pre>

    <p>Render Yii partial views:</p>

    <pre class="prettyprint linenums lang-php">Yii::app()->controller->renderPartial('/site/_partial');</pre>

    <p>Render Yii widgets:</p>

        <pre class="prettyprint linenums lang-php">Yii::app()->controller->widget('zii.widgets.CDetailView', array(
    'data' => array('hello' => 'world'),
));</pre>

    <p>Run OpenCart controller:</p>

    <pre class="prettyprint linenums lang-php">Yii::app()->runOcController('common/home');</pre>

    <p>Get OpenCart controller output:</p>

        <pre class="prettyprint linenums lang-php">echo Yii::app()->getOcControllerOutput('common/header');
echo 'hello world';
echo Yii::app()->getOcControllerOutput('common/footer');</pre>

    <p>Output OpenCart language label:</p>
    
    <pre class="prettyprint linenums lang-php">Yii::t('module/bestseller', 'heading_title');</pre>

    <h3 id="usage/gii">Gii Code Generator</h3>

    <p>You can use Yii's awesome code generator from your OpenCart admin, just like you can in any other Yii app. Simply browse to your admin
        <code>admin/index.php?route=gii</code>.</p>

    <p>To tune the Gii configuration or security access edit <code>admin/yiiembed/config/main.php</code>.</p>

    <h4>PrefixModel Generator</h4>

    <p>Use the PrefixModel Generator to generate all your models in one action. </p>

    <p>Select the Code Template <code>yiiembed</code> to generate models the same as ours.</p>

    <h4>ModelDoc Generator</h4>

    <p>Use the ModelDoc Generator to replace the phpdoc blocks in your models.</p>

    <h4>Other Generators</h4>

    <p>All the default Gii Generators including Controller Generator, Crud Generator, Form Generator, Model Generator and Module Generator are also available.</p>

</div>
</div>

<div id="footer">
    <div class="container">
        <div class="row">
            <div class="col-lg-8">
                <h3>Support</h3>
                <ul class="list-unstyled">
                    <li>Does this site need improvement? Go ahead and
                        <a href="https://github.com/cornernote/yii-embed-opencart/edit/gh-pages/index.html">suggest a change</a>.
                    </li>
                    <li>Found a bug, or need help using this project? Check the
                        <a href="https://github.com/cornernote/yii-embed-opencart/issues">open issues</a> or
                        <a href="https://github.com/cornernote/yii-embed-opencart/issues/new">create an issue</a>.
                    </li>
                </ul>
                <h4>License</h4>
                <p>
                    <a href="license.html" class="fancybox" data-fancybox-type="ajax">BSD-3-Clause</a>, Copyright &copy; 2013-2014
                    <a href="mailto:info@mrphp.com.au">Mr PHP</a></p>
                <h4>More from MrPHP</h4>
                <p><a href="http://cornernote.github.io">cornernote.github.io</a> | <a href="http://mrphp.com.au">MrPHP.com.au</a></p>
            </div>
            <div class="col-lg-4">
                <h4>Yii Embed for OpenCart</h4>
                <ul class="list-unstyled">
                    <li><a href="http://cornernote.github.io/yii-embed-opencart">Documentation</a></li>
                    <li><a href="https://github.com/cornernote/yii-embed-opencart">GitHub Project</a></li>
                    <li><a href="http://www.yiiframework.com/extension/yii-embed-opencart">Yii Extension</a></li>
                    <li>
                        <a href="http://www.opencart.com/index.php?route=extension/extension/info&extension_id=15059">OpenCart Extension</a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
    <div id="project-icons">
        <div class="container" id="contributors">
            <h5></h5>
            <ul class="text-center"></ul>
        </div>
        <div class="text-center">
            <p>
                <a href="http://mrphp.com.au"><img src="https://raw.github.com/cornernote/mrphp-assets/master/img/code-banner.png" alt="Mr PHP"></a>
                <a href="https://www.ohloh.net/p/yii-embed-opencart"><img src="https://www.ohloh.net/p/yii-embed-opencart/widgets/project_thin_badge.gif" alt="Project Stats"></a>
            </p>
            <!--
            <p>
                <a href="https://packagist.org/packages/cornernote/yii-embed-opencart"><img src="https://poser.pugx.org/cornernote/yii-embed-opencart/v/stable.png" alt="Latest Stable Version"></a>
                <a href="https://travis-ci.org/cornernote/yii-embed-opencart"><img src="https://travis-ci.org/cornernote/yii-embed-opencart.png?branch=master" alt="Build Status"></a>
            </p>
            -->
        </div>
    </div>
</div>

<!-- load js last -->
<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.0.3/js/bootstrap.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.5/jquery.fancybox.pack.js"></script>
<script src="//google-code-prettify.googlecode.com/svn/loader/run_prettify.js"></script>
<script src="js/main.js"></script>

<script>
    (function (i, s, o, g, r, a, m) {
        i['GoogleAnalyticsObject'] = r;
        i[r] = i[r] || function () {
            (i[r].q = i[r].q || []).push(arguments)
        }, i[r].l = 1 * new Date();
        a = s.createElement(o),
                m = s.getElementsByTagName(o)[0];
        a.async = 1;
        a.src = g;
        m.parentNode.insertBefore(a, m)
    })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');
    ga('create', 'UA-46879709-8', 'cornernote.github.io');
    ga('send', 'pageview');
</script>

</body>
</html>
